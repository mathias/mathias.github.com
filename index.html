
<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>blog.mattgauger.com</title>
    <meta name="author" content="Matt Gauger">

    
    <meta name="description" content="Clojure Data Science: Ingesting Your Gmail Inbox This is Part 1 of a series of blog posts inspired by the exercises from Agile Data Science with &hellip;">
    

    <link href="/atom.xml" rel="alternate" title="blog.mattgauger.com" type="application/atom+xml">
    <link rel="canonical" href="">
    <link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    

</head>


<body>
  <header class="inner"><div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>

      <a href="/" class="brand">blog.mattgauger.com</a>

      <div class="nav-collapse">
        <nav class="menu left"><ul class="nav">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog Archives</a></li>
  <li><a href="/presentations">Presentations</a></li>
  
  <li class="divider-vertical"></li>
  <li><a class="rss" href="/atom.xml" title="RSS">RSS</a></li>
  
</ul>
</nav>
        <div class="right">
          <form class="navbar-search pull-right" action="http://google.com/search" method="get">
            <input class="input-medium search-query span2" type="text" name="q" results="0" placeholder="Search">
            <input type="hidden" name="q" value="site:blog.mattgauger.com">
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</header>
  <div class="container bottom-left-rounded-corner bottom-right-rounded-corner" id="page-container">
    <div class="row">
  <article class="page span8 offset2">
    
    


  <article class="post">
    
    <h1 class="title"><a href="/blog/2014/03/30/clojure-data-science-ingesting-your-gmail-inbox/">Clojure Data Science: Ingesting Your Gmail Inbox</a></h1>
    <div class="entry">
        <hr />

<p>This is Part 1 of a series of blog posts inspired by the exercises from <a href="http://shop.oreilly.com/product/0636920025054.do">Agile Data Science</a> with Clojure. You may be interested in my <a href="http://blog.mattgauger.com/blog/2014/03/14/agile-data-science-review-and-thoughts/">review</a> of the book.</p>

<hr />

<p>For this blog post series, we are going to use your Gmail inbox as a dataset for an exploration of data science practices. Namely, we will use your email for machine learning and natural language processing applications. Email makes interesting data to process:</p>

<ul>
<li>it has lots of metadata that we can use as features <a href="#cds-gmail-footnote-1" name="cds-gmail-footnote-1-return">[1]</a></li>
<li>we can model the relationships of senders and receivers as a graph</li>
<li>each message has a body of text associated with it that we can analyze</li>
<li>gaining insights from our personal communication is far more interesting than using an open data set!</li>
</ul>


<p><strong>Note:</strong> This is not an intro-to-Clojure blog post. If you need a tutorial that starts with the basics, I recommend the <a href="http://aphyr.com/tags/Clojure-from-the-ground-up">Clojure from the ground up</a> blog post series by <a href="https://twitter.com/aphyr">Aphyr</a>. It does an excellent job at introducing concepts in Clojure.</p>

<p>In this post, I follow my typical Clojure workflow: I open a REPL and begin exploring the problem space. I look at individual pieces of data and start transforming them. When I write some functionality that I like for one piece of data, I try to extract it into the source code as a function that can work for any data our project may see. In this way, we can build up the project to contain the functions that are necessary to get to our goal.</p>

<p>So what is our goal for this blog post? Well, we want to fetch all emails from our Gmail inbox. We want to get metadata for each email, including things like who sent it and when it was sent. Then, we want to save the messages into a database so we can do further processing in later posts.</p>

<p>Starting off, make a new basic Clojure project with lein. I&#8217;ve named my project <a href="https://github.com/mathias/autodjinn">autodjinn</a> after <a href="http://en.wikipedia.org/wiki/Email#Origin">AUTODIN</a>, one of the first email networks. You can use the <a href="https://github.com/mathias/autodjinn">repo</a> to refer to and to clone to follow along. At the beginning of each subsequent post, I&#8217;ll provide a SHA that you can reset the code to. Feel free to name your project whatever you want; just be sure to pay attention to the changes in filenames and namespaces as we go along!</p>

<p>Create the project and enter it:</p>

<script src="https://gist.github.com/mathias/9861772.js"></script>


<p>To import our Gmail data, we will use a Clojure library called <a href="https://github.com/owainlewis/clojure-mail">clojure-mail</a>. Clojure-mail is still under active development and is likely to change. For this blog post, we&#8217;ll be using version <code>0.1.6</code> to ensure compatibility between the code in this post and the library.</p>

<p>Edit <code>project.clj</code> to contain your information and add the <code>[clojure-mail "0.1.6"]</code> dependency:</p>

<script src="https://gist.github.com/mathias/9861804.js"></script>


<p>We&#8217;ll start by working in <code>src/autodjinn/core.clj</code> and later move the functionality out into a script for our email import task. Open up the file in your favorite editor and launch a REPL.</p>

<p>In your REPL, <code>(use 'autodjinn.core)</code> and verify it worked by running <code>(foo "MYNAME")</code>. You should see &#8220;MYNAME Hello, World!&#8221; printed out. Feel free to remove the <code>(defn foo…)</code> in <code>core.clj</code> now. We will not need it.</p>

<p>You may want to use something like Emacs&#8217; <a href="https://github.com/clojure-emacs/cider">cider</a> or LightTable&#8217;s InstaREPL as your REPL environment. But you can use the regular Clojure REPL to build this project, as well. If you are not working with a REPL integrated to your editor, you will need to run <code>(use 'autodjinn.core :reload)</code> to force a reload of the code each time you save.</p>

<h2>Connecting to Gmail</h2>

<p>Our first goal is to connect to our inbox and verify that we can read email from it. To do that, we&#8217;re going to need to use our Gmail address and password &mdash; which we don&#8217;t want to put into our source files. <strong>It&#8217;s bad practice to put a password or a private key into a source file or check it into our repo! Just don&#8217;t do it!</strong></p>

<p>Instead, we will use a nice library called <a href="https://github.com/james-henderson/nomad">nomad</a> to load a config file containing our email address and password. We will add the config file to <code>.gitignore</code> so that it is never saved into our code.</p>

<p>Add the line <code>[jarohen/nomad "0.6.3"]</code> to your <code>project.clj</code> dependencies before moving on, and run <code>lein deps</code> in a console to pull in the dependency.</p>

<p>Back in our <code>core.clj</code> add the require statements for <code>clojure-mail</code> and <code>nomad</code> to your ns macro like this:</p>

<script src="https://gist.github.com/mathias/9863912.js"></script>


<p>Then create a new file in <code>resources/config/autodjinn-config.edn</code>. It should look like this, with your email address and password filled in:</p>

<script src="https://gist.github.com/mathias/9864315.js"></script>


<p>Now open up your <code>.gitignore</code> file and add the following line to it:</p>

<script src="https://gist.github.com/mathias/9866473.js"></script>


<p>Following <a href="https://github.com/james-henderson/nomad#hello-world">nomad&#8217;s README</a>, we need to load our config file and pull out our <code>gmail-username</code> and <code>gmail-password</code> keys. We add to the following to <code>core.clj</code> after the <code>ns</code> macro:</p>

<script src="https://gist.github.com/mathias/8c0849fc0e137f1bd611.js"></script>


<p>Using the <code>get</code> function here is a safe lookup for maps that returns <code>nil</code> if nothing is found for the key. Back in our REPL, we can see this in action with some quick experimentation:</p>

<script src="https://gist.github.com/mathias/9864411.js"></script>


<p>We could also use the shorter <code>(:keyname mymap)</code> syntax here, since symbols are an invocable function that looks up a key in a map. But the <code>get</code> function reads better than <code>(:gmail-username (autodjinn-config))</code> in my opinion.</p>

<p>In your REPL, you should now be able to get the values for <code>gmail-username</code> and <code>gmail-password</code>:</p>

<script src="https://gist.github.com/mathias/9864585.js"></script>


<p>Note that since I&#8217;m in the <code>user</code> namespace here, I had to qualify the vars with their <code>autodjinn.core</code> namespace. If this is confusing, you might want to read up on <a href="http://clojure-doc.org/articles/language/namespaces.html">namespaces in Clojure</a> before moving on. (See also: the &#8216;Namespaces&#8217; section in <a href="http://aphyr.com/posts/311-clojure-from-the-ground-up-logistics">Clojure from the ground up: logistics</a>.)</p>

<p><code>clojure-mail</code> requires us to open a connection to Gmail with the <code>gen-store</code> function (<a href="https://github.com/owainlewis/clojure-mail/blob/c3aad67b42aad96405d4c329ca48e29b7960d412/src/clojure_mail/core.clj#L80-L83">src</a>). We then pass that connection around to various functions to interact with our inbox. Define a var called <code>my-store</code> in your <code>core.clj</code> that does this with our email address and password:</p>

<script src="https://gist.github.com/mathias/9865909.js"></script>


<p>Make sure the <code>(def my-store…</code> above has been run in your REPL and then take a look at our open connection:</p>

<script src="https://gist.github.com/mathias/9865937.js"></script>


<p>The type of <code>my-store</code> should be an <code>IMAPSSLStore</code> as above. If it didn&#8217;t work, you&#8217;ll see a string error message when you try to define <code>my-store</code>.</p>

<h2>Your inbox as a list</h2>

<p>Now we&#8217;ll use our REPL to build up a function that will eventually import all of our email. To start, we can use the <code>inbox</code> function (<a href="https://github.com/owainlewis/clojure-mail/blob/c3aad67b42aad96405d4c329ca48e29b7960d412/src/clojure_mail/core.clj#L198-L201">src</a>) from <code>clojure-mail</code> to get a seq of messages in our inbox. Note that since it is a seq and inboxes can be very large, we limit it with the <code>take</code> function.</p>

<script src="https://gist.github.com/mathias/9866030.js"></script>


<p>If everything is working, you should see a list of of the <code>IMAPMessage</code>s returned by the last line in your REPL.</p>

<p>What if, instead, we wanted to loop over many messages and print out their subjects? We can pull in the <code>message</code> namespace (<a href="https://github.com/owainlewis/clojure-mail/blob/master/src/clojure_mail/message.clj">src</a>) from <code>clojure-mail</code>, which gives us convenience functions for getting at message data.</p>

<p>You&#8217;ll have to be careful running this next line &mdash; on a large inbox it&#8217;ll print out the subject of everything in your inbox! If you have a lot of messages, consider wrapping the call to <code>inbox</code> in a <code>take</code> as above.</p>

<script src="https://gist.github.com/mathias/9866059.js"></script>


<p>Those are the subject lines of the 4 messages in the inbox of my test account, so I know that this is working. Save our <code>doseq</code> line into a function called <code>ingest-inbox</code>; we&#8217;ll come back to it later:</p>

<script src="https://gist.github.com/mathias/9866289.js"></script>


<h2>Examining messages</h2>

<p>Before we move on, let&#8217;s take a look at an individual message and what we can get out of it from the <code>message</code> namespace.</p>

<script src="https://gist.github.com/mathias/9866195.js"></script>


<p>From this, we can see a few things:</p>

<ul>
<li>The ID returned by <code>message/id</code> looks like a good candidate to get good unique IDs for each message when we store the messages. But we might want to strip off those angle brackets first.</li>
<li>The <code>message/message-body</code> function doesn&#8217;t return a string of the body. Instead, it returns a list of maps which contains the <code>text/plain</code> form of the body and the <code>text/html</code> form. We will have to extract each from the map so that we can use the plaintext version for things like language processing. We&#8217;ll also keep the HTML version in case we need it later.</li>
<li>If you started digging in to the <code>message</code> namespace&#8217;s source you may have noticed that we don&#8217;t have functions for getting date sent or date received for a message. Nor can we get a list of addresses CCed or BCCed for the message. We&#8217;ll have to write those functions ourselves.</li>
</ul>


<h2>Cleaning up the IDs</h2>

<p>Let&#8217;s focus on writing a function to clean up the ID returned by the <code>message/id</code> function. Recall that such IDs look like <code>&lt;CAJiAYR90LbbN6k8tVXuhQc8f6bZoK647ycdc7mxF5mVEaoLKHw@mail.gmail.com&gt;</code></p>

<p>The <code>clojure.string</code> namespace provides a <code>replace</code> function which does simple replacement on a string. We can use it like this:</p>

<script src="https://gist.github.com/mathias/9866344.js"></script>


<p>That worked for replacing the angle brackets for the original string. But remember that data structures are immutable in Clojure, including strings. Replacing the first angle bracket didn&#8217;t change the original string when we tried to replace the other angle bracket. We need something that allows us to build up an intermediate value and pass it to the next function. For that, we will use the <a href="http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/-%3e">thread-first</a> macro: <code>-&gt;</code>. It is easiest if I show the macro in use with some comments showing what the intermediate values would be at each step:</p>

<script src="https://gist.github.com/mathias/9866380.js"></script>


<p>It is called the <strong>thread-first</strong> macro because it threads through the first argument to each function. In this case, <code>clojure.string/replace</code>&#8217;s first argument is the string to replace on. So the each successively returned value gets passed to the next function above.</p>

<p>Now that we&#8217;ve figured out how to clean up that ID, we will create a function to clean up any ID we pass it:</p>

<script src="https://gist.github.com/mathias/9866436.js"></script>


<h2>Extracting the message bodies</h2>

<p>Recall the <code>message/message-body</code> call above:</p>

<script src="https://gist.github.com/mathias/9866777.js"></script>


<p>Ideally, we want to write a function that can get the <code>text/plain</code> body out of this value, and another function that can get the <code>text/html</code> body out. Notice that the <code>:content-type</code> values aren&#8217;t quite so simple as just selecting the item in the list where the string <code>text/plain</code> appears. We will need our function to ignore the additional information in the <code>:content-type</code> value, which includes things like string encodings.</p>

<p>Let&#8217;s look at just the first map in the list returned by <code>message/message-body</code>:</p>

<script src="https://gist.github.com/mathias/9866861.js"></script>


<p>If we build a predicate function that can detect when the <code>:content-type</code> key is the type we want, we can use it in a <code>filter</code> function to choose the correct type of body in our functions.</p>

<p>Notice that <code>TEXT/PLAIN</code> and <code>TEXT/HTML</code> are always separated from the rest of the content-type by a semicolon, and it always appears first. You&#8217;d have to look at a few messages from your inbox to arrive at the same conclusion, but I&#8217;ve already done the work and can assure you that the previous statement is true.</p>

<p>Then, an easy to to get at the part of the content-type we want would be to split on the semicolon and take the first element returned:</p>

<script src="https://gist.github.com/mathias/9867049.js"></script>


<p>This leads us to a function to first clean up the content-type string, and then our predicate function to detect if it is the one we want:</p>

<script src="https://gist.github.com/mathias/9867072.js"></script>


<p>To finish off our work on the message bodies, we want to filter the list returned by <code>message/message-body</code>:</p>

<script src="https://gist.github.com/mathias/9867356.js"></script>


<p>And turn it into a function that works for any message bodies list:</p>

<script src="https://gist.github.com/mathias/9867382.js"></script>


<p>Note that we&#8217;ve also used this function to create two convenience functions, one for extracting plaintext bodies and one for extracting HTML bodies. By keeping functions simple and small, we can build up useful functions for our project rather than try to plan it all out ahead of time.</p>

<h2>Getting more information out of the IMAPMessages</h2>

<p>As noted above, we will need to write a few more functions to get the fields of the <code>IMAPMessage</code>s that we cannot get through this version of <code>clojure-mail</code>. Recall that we want to get CC list, BCC list, date sent, and date received values. To do that, we will use Java interop functionality. It&#8217;s really not as bad as it sounds. Remember that the <code>IMAPMessage</code>s we see are Java instances of the <code>IMAPMessage</code> class. Calling a method on an instance is accomplished by using a dot before the method name, with the method in the function position, such as: <code>(.javaMethod some-java-instance)</code></p>

<p>To start, we can look at <code>clojure-mail</code>&#8217;s <a href="https://github.com/owainlewis/clojure-mail/blob/c3aad67b42aad96405d4c329ca48e29b7960d412/project.clj">project.clj</a> and see that it depends on <code>javax.mail</code>. The next step is to find the documentation for the Java implementation of <code>javax.mail.Message</code>, which <a href="http://docs.oracle.com/javaee/6/api/javax/mail/Message.html">lives here</a>.</p>

<p>In the REPL, we can try some of the Java interop on our <code>my-msg</code>:</p>

<script src="https://gist.github.com/mathias/9876540.js"></script>


<p>The datetimes for each message are automatically turned into Clojure instants for us, which is convenient. If we dig into how the <code>clojure-mail.message/to</code> function [<a href="https://github.com/owainlewis/clojure-mail/blob/c3aad67b42aad96405d4c329ca48e29b7960d412/src/clojure_mail/message.clj#L16-L20">src</a>] works, we see that it is using the <code>.getRecipients</code> method. <code>.getRecipients</code> takes the message and a constant of a <code>RecipientType</code>. For our purposes, we want the <code>javax.mail.Message$RecipientType/CC</code> and <code>javax.mail.Message$RecipientType/BCC</code> recipients:</p>

<script src="https://gist.github.com/mathias/9876632.js"></script>


<p>The last line maps the <code>str</code> function across each element returned, so that we get the string representation of the email addresses. That way, our database can just store the strings.</p>

<p>As before, now that we know how to use these methods in the REPL, we write functions in <code>core.clj</code> to take advantage of our newfound knowledge:</p>

<script src="https://gist.github.com/mathias/9876737.js"></script>


<p>In the REPL, it should now be possible to get a nice map representation of all the fields on the message we care about:</p>

<script src="https://gist.github.com/mathias/9876884.js"></script>


<p>Congrats on making it this far. We&#8217;ve used quite a few neat little features of Clojure and the libraries we&#8217;re building this project with to get here.</p>

<p>The last step we&#8217;ll go through in this post is to get these messages into a database.</p>

<h2>Enter Datomic, the immutable datastore</h2>

<p><a href="http://www.datomic.com/">Datomic</a> is a great database layer built on Clojure that gives us a database value representing immutable data. New transactions on the database create new database values. It fits very well with Clojure&#8217;s own concept of <a href="http://clojure.org/state">state and identity</a> because it was designed by the same folks as Clojure. Plus, Datomic is meant to grow and scale in modern environments like AWS, with many backend datastore options to run it on.</p>

<p>There&#8217;s some important reasons why you might choose Datomic as your database for a data science / machine learning application:</p>

<ul>
<li>There are various storage backends, so you can grow from tens of thousands of rows in PostgreSQL on a developer&#8217;s laptop to millions of records (or more) in Riak or DynamoDB on AWS. That is, it has a good migration path from small datasets to big data through the Datomic import/export process</li>
<li>The concept of time associated with each value in Datomic means that we can query for historical data to compare against</li>
<li>Datomic has a lightweight schema compared to a relational database like PostgreSQL. Schemas are just data! When we begin computing new values from our dataset, we can add new types of entities easily at the same time.</li>
<li>Datomic&#8217;s schemas allow us to treat it as a key-value store, relational database, or even build a graph store on top of it, if we need to</li>
</ul>


<p><strong>Note</strong>: I won&#8217;t go through setting up an entire Datomic installation here. It&#8217;s worth reading up on the <a href="http://docs.datomic.com/">docs</a> and the <a href="http://www.datomic.com/rationale.html">rationale</a> behind Datomic&#8217;s design.</p>

<p>You can get the <a href="https://my.datomic.com/downloads/free">Datomic free build</a> if you like, but you will be limited to in-memory stores. It is unlikely that your Gmail inbox will fit into memory on your dev machine. Instead, I recommend signing up for the free <a href="http://www.datomic.com/get-datomic.html">Datomic Pro Starter Edition</a>. (The free Starter Edition is fine because you will not be using this project in a commercial capacity.) Once you have Datomic Pro downloaded and installed in your local Maven, I recommend using the PostgreSQL storage adapter locally with memcached. Follow the guides for configuring storage on the <a href="http://docs.datomic.com/storage.html">Datomic Storage</a> page.</p>

<p>Add the correct line to your <code>project.clj</code> dependencies for the version of Datomic you&#8217;ll be using (mine was <code>[com.datomic/datomic-pro "0.9.4384"]</code> which might be a bit out of date and likely won&#8217;t match yours.) Now we can start using Datomic in our <code>core.clj</code> and our REPL.</p>

<p>The first thing we need is the URI where the Datomic database lives. When we start up the Datomic transactor, you will see a DB URI that looks something like <code>datomic:sql://DBNAMEHERE?jdbc:postgresql://localhost:5432/datomic?user=datomic&amp;password=datomic</code> in the output. Grab that URI and add it to our <code>resources/config/autodjinn-config.edn</code>:</p>

<script src="https://gist.github.com/mathias/9877346.js"></script>


<p>Back at the top of <code>core.clj</code>, save that value to a var as we did with <code>gmail-username</code> and <code>gmail-password</code>:</p>

<script src="https://gist.github.com/mathias/9877374.js"></script>


<p>And then in the REPL:</p>

<script src="https://gist.github.com/mathias/9879199.js"></script>


<p>Note that according to the <a href="http://docs.datomic.com/clojure/index.html#datomic.api/create-database">datomic clojure docs for the create-database function</a>, it returns true if the database was created, and false if it already exists. So running <code>create-database</code> every time we run our script is safe, since it won&#8217;t destroy data.</p>

<p>If the above work in the REPL doesn&#8217;t work, it is likely your code is unable to talk to your running Datomic, or your Datomic transactor is not configured correctly. Diagnose it with Googling and reading the docs until you get it to work, then move on.</p>

<p>Calling <code>(d/db db-connection)</code> gives us the current value of our database. In most cases, we want to just get the most current value. So, we can write a convenience function <code>new-db-val</code> to always get us the current (and possibly different) database value. But there are cases where we want to coordinate several queries and use the same database values for each. In those cases, we won&#8217;t use the function get the latest database value, but rather pass this database value to the queries so that all query against the same state.</p>

<p>In our <code>core.clj</code>, we can add the code we need to create the database, get our connection, and the convenience <code>new-db-val</code> function:</p>

<script src="https://gist.github.com/mathias/9879246.js"></script>


<p>Next, we need to tell Datomic about the schema of our data. Schemas are just data that you run as a transaction on the database. Reading up on the <a href="http://docs.datomic.com/schema.html">Schema</a> page of the Datomic docs might be helpful to understand what&#8217;s going on here. The short version is that we define each attribute of an email and set up its properties. The collection of all attributes together will constitute a <code>mail</code> entity, so we namespace all the attributes under the <code>:mail/</code> namespace.</p>

<script src="https://gist.github.com/mathias/9879323.js"></script>


<p>We add that var def to our <code>core.clj</code> because it is, after all, just data. We may choose later to move it to its own <code>edn</code> file, but for now, it can live in our source code. Next, we want to apply this schema to our database with a transaction. That looks like this:</p>

<script src="https://gist.github.com/mathias/9879355.js"></script>


<p>Now we put that transaction in a convenience function in <code>core.clj</code> that we&#8217;ll run every time we run this file. The function will ensure that our database is &#8216;converged&#8217; to this schema. Running a transaction will create a new database value. But it will not blow away any data that we had in the database by running this transaction many times. It will simply try to update the existing attributes, and nothing in the attributes themselves need change. It is far more work to retract (delete) data in Datomic than it is to add or update it. This leads to much more safety around working with data without worrying that we will destroy data, and it encourages a REPL-based exploration of the data and its history.</p>

<script src="https://gist.github.com/mathias/9879424.js"></script>


<p>Now that our <code>mail</code> entities are defined in Datomic, we can try a query to find all the entity-IDs where any <code>:mail/uid</code> value is present. Read up on the <a href="http://docs.datomic.com/query.html">Query</a> page of the Datomic docs to dig into querying deeper. You might also be interested in the excellent <a href="http://www.learndatalogtoday.org/">Learn Datalog Today</a> website to learn more about querying Datomic with Datalog.</p>

<script src="https://gist.github.com/mathias/9879491.js"></script>


<p>Since we have no <code>mail</code> entities in our database, Datomic returns an empty set. So now we reach the end of task: We can ingest some emails and save them in our database! Return to the <code>ingest-inbox</code> function that we left before. Here&#8217;s what the updated version will look like:</p>

<script src="https://gist.github.com/mathias/9879494.js"></script>


<p>We use the <code>@</code>-sign before the <code>(d/transact…)</code> call because Datomic normally returns a promise of the completed transaction. However, we want to force Datomic to complete each transaction before moving on by deref-ing it with the <code>@</code>-sign. Per the Clojure docs: &#8220;Calls to deref/@ prior to delivery will block.&#8221;</p>

<p>If you run this function in your REPL, you should see it start to ingest your email from Gmail!</p>

<script src="https://gist.github.com/mathias/9879552.js"></script>


<p>Note that this could a take a <strong>long time</strong> if you&#8217;ve chosen to import a really large Gmail inbox! You might want to stop the import at some point; in most REPLs <code>Ctrl-c</code> will stop the running function.</p>

<p>If we query for our entity-IDs again, as above, we should see some values returned!</p>

<p>What does one of those database entities look like when we run it through Datomic&#8217;s <a href="http://docs.datomic.com/clojure/index.html#datomic.api/entity">entity</a> and <a href="http://docs.datomic.com/clojure/index.html#datomic.api/touch">touch</a> functions to instantiate all its attributes?</p>

<script src="https://gist.github.com/mathias/9879636.js"></script>


<h2>Wrapping up</h2>

<p>That&#8217;s it for this blog post. It took a little setup, but we were able to build up a working Gmail import tool with help from our REPL and some nice Clojure libraries.</p>

<p>Next time, we&#8217;ll be looking at doing some basic querying of the data, including getting a count of the number of times each email address has sent you an email.</p>

<p>Comments? Questions? Feel free to contact me at <a href="mailto:contact@mattgauger.com">contact@mattgauger.com</a>. I&#8217;d love to hear from you.</p>

<hr />

<p><a name="cds-gmail-footnote-1"></a>
<strong>1</strong> In this case, machine learning <em>features</em>, which are the input variables for our learning tasks. Not software features that we a client might ask us to implement. See: <a href="https://en.wikipedia.org/wiki/Feature_learning">Feature learning - Wikipedia, the free encyclopedia</a>.
<a href="#cds-gmail-footnote-1-return">↩</a></p>

        
        
    </div>

    <div class="meta">
        <div class="author">
  

<span class="byline author vcard">Posted by <span class="fn">Matt Gauger</span>.</span>
</div>
        <div class="date">












<time datetime="2014-03-30T14:44:00-05:00" pubdate  data-updated="true" >Mar 30<span>th</span>, 2014</time>.</div>
        <div class="tags">

</div>
    </div>

  </article>


  <article class="post">
    
    <h1 class="title"><a href="/blog/2014/03/20/a-quick-dashboard-in-hoplon-and-castra/">A Quick Dashboard in Hoplon &amp; Castra</a></h1>
    <div class="entry">
        <p><em>Note:</em> I began writing a much longer blog post that went into a ton of detail about how to build an app dashboard that used Hoplon and Castra. The kind of dashboard that just consumes JSON API endpoints from another app or other data sources. Such dashboards update on the fly in the browser. Many apps these days need a dashboard like this to monitor stats: worker job queues, database size, average response times, etc.</p>

<p>Rather than that long blog post, I wanted to simply show the steps I would take to build such a dashboard with <a href="http://hoplon.io">Hoplon</a> and <a href="https://github.com/tailrecursion/castra">Castra</a>. I won&#8217;t go into detail here or explain either Hoplon or Castra &mdash; go read on your own first, and also look into <a href="https://github.com/tailrecusion/boot">boot</a>, the build tool this uses.</p>

<p>If you want to follow along, I&#8217;ve provided a <a href="https://github.com/mathias/gleam">repo</a>. The <a href="https://github.com/mathias/gleam/blob/30b4976b313c950c6cc97e64c65036eb21d75378/README.md">README</a> has instructions for getting setup. Assuming you have boot installed, you can just run <code>boot gleam-app</code> to get started.</p>

<p>So here&#8217;s how I&#8217;d build up a dashboard, in several iterations:</p>

<h2>Static data in the browser:</h2>

<p>First, we get some data into the HTML using Hoplon cells:</p>

<script src="https://gist.github.com/mathias/9670739.js"></script>


<p>You&#8217;ll want to <code>git reset --hard 69b070</code> to get to this point.</p>

<h2>Move the data to ClojureScript:</h2>

<p>In <code>src/cljs/gleam/rpc.cljs</code>:</p>

<script src="https://gist.github.com/mathias/9635157.js"></script>


<p>And take out the <code>(def articles…)</code> from <code>index.html.hl</code>. After boot recompiles everything, you should still see the data in the page.</p>

<p>To get to this point, you can run <code>git reset --hard d63f299</code>.</p>

<h2>Move the data to the server side</h2>

<p>Change <code>src/cljs/gleam/rpc.cljs</code> again, this time to make a remote call for data:</p>

<script src="https://gist.github.com/mathias/9671172.js"></script>


<p>On the backend, we need something like this in <code>src/castra/gleam/api/gleam.clj</code>:</p>

<script src="https://gist.github.com/mathias/9671200.js"></script>


<p>The Hoplon HTML file changes in the script tag at the top to use the new ClojureScript remote call and start up the polling:</p>

<script src="https://gist.github.com/mathias/9671220.js"></script>


<p>To get to this point in the example repo, you can do <code>git reset --hard 0bad1e5</code>.</p>

<h2>Real time data</h2>

<p>The last step that I will show is to verify that we are in fact getting regular updates of data from the back end.</p>

<p>Change your Castra Clojure file to look like this:</p>

<script src="https://gist.github.com/mathias/9671661.js"></script>


<p>To get to this point, you can do a <code>git reset --hard f19325</code></p>

<h2>Talking to a remote service.</h2>

<p>The last step here is left as an exercise for the reader. You can imagine replacing the <code>articles</code> function in <code>src/castra/gleam/api/gleam.clj</code> with something that polls a remote JSON API for data. Or you could look at my social news app <a href="http://github.com/mathias/gnar">gnar</a> for inspiration on using a Postgres database for data.</p>

<p>I hope to finish up a post with full explanations soon. Castra is relatively new, and it&#8217;s worth explaining how some of the pieces fit together. My explanation should include more complicated interaction. like user authentication. I will be publishing that blog post after I get back from <a href="http://clojurewest.org">ClojureWest</a> next week!</p>

<p>Let me know what you thought of this post by shooting me an <a href="mailto:contact@mattgauger.com">email</a>. I&#8217;d love to hear from you.</p>

        
        
    </div>

    <div class="meta">
        <div class="author">
  

<span class="byline author vcard">Posted by <span class="fn">Matt Gauger</span>.</span>
</div>
        <div class="date">












<time datetime="2014-03-20T13:29:00-05:00" pubdate  data-updated="true" >Mar 20<span>th</span>, 2014</time>.</div>
        <div class="tags">

</div>
    </div>

  </article>


  <article class="post">
    
    <h1 class="title"><a href="/blog/2014/03/14/agile-data-science-review-and-thoughts/">Agile Data Science: Review and Thoughts</a></h1>
    <div class="entry">
        <p><a href="http://shop.oreilly.com/product/0636920025054.do">
  <img src="//blog.mattgauger.com/images/agile_data_science_cover.gif" alt="Agile Data Science cover" style="display: block; float:right; margin: 10px;">
</a></p>

<p>Recently, I read the book <a href="http://shop.oreilly.com/product/0636920025054.do">Agile Data Science</a> by Russell Jurney. The book covers data science and how the author applies an agile workflow and powerful tooling to accomplish tasks. While I found the book interesting, and would recommend it as a good introduction, I have some issues with the book that I&#8217;d like to discuss. I&#8217;d like to go over the book and the tools briefly, if only to save my thoughts for later.</p>

<p>A quick note: data science is actively being defined by the web community as the process of analyzing large data sets with statistics and other approaches. That definition is ongoing and changing all the time. Big Data is the term that the industry seems to be using for such large datasets. You&#8217;ll also see the terms machine learning, analytics, and recommender systems mentioned: these are all various sub-topics that I won&#8217;t cover in depth here.</p>

<p>The book centers around the use of <a href="http://hadoop.apache.org/">Hadoop</a>. In turn, Hadoop is commanded by writing and running <a href="https://pig.apache.org/">Apache Pig</a> scripts in the book. Pig allows you to write workflows in a high-level scripting language that may compose many Hadoop jobs into one system. With Pig, you need not worry about the specifics of what each Hadoop job is doing when you write a Pig script.</p>

<p>Hadoop is patterned after Google&#8217;s <a href="http://static.googleusercontent.com/media/research.google.com/en/us/archive/mapreduce-osdi04.pdf">MapReduce paper</a>. Google had large clusters of computers and large data sets that it wanted to process on those clusters. What they came up with was a simple idea: Write a single program that would specify a <code>map</code> function to run across tuples of all the input data. Add a <code>reduce</code> function that compiles that output down into the expected format. MapReduce coordinates deploying the program to each worker machine, divvying up the input data across the different machines, gathering up the results, and handling things like restarts after failures. This was a huge success inside Google, and Hadoop implements that architecture with improvements.</p>

<p>It should be noted that this MapReduce architecture is essentially batch-processing for large amounts of data. The same system would have a hard time with continuous streams of data.</p>

<p>Hadoop is, unfortunately, my first stumbling block with learning to process big data.</p>

<p>Configuring and running Hadoop is not easy. I have far more experience as a developer than a sysadmin (or today&#8217;s term: devops engineer). There exists more than one &#8220;distribution&#8221; of Hadoop and more than one versioning scheme between those. This means that understanding what&#8217;s available, how to configure it, and whether search results are relevant to you is quite hard for the unexperienced.  Imagine the confusion of trying to install a Debian Linux distro and only being able to find instructions for Red Hat Linux; further, not being able to tell what the problem was when it wouldn’t boot and printed a Debian-specific error.</p>

<p>It seems like Hadoop is designed for to be run by someone whose full-time job is to configure and maintain that cluster. That person will need to have enough experience with all the different choices to have an opinion on them. For a developer wanting to run things locally before committing to configuring (and paying for!) a full cluster out on AWS, it was daunting.</p>

<p>Luckily for me, <a href="https://github.com/charlesflynn">Charles Flynn</a> has created a neat repo on Github at <a href="https://github.com/charlesflynn/agiledata">charlesflynn/agiledata</a>. It builds a local development VM for the Agile Data Science book, with all the dependencies installed and the book&#8217;s code in the right place to run. With that project, I was able to get up and running with the project quickly and found it useful to not have to sink anymore time into configuring Hadoop. I&#8217;d like to give another shout-out to Charles for this great resource and the work done to make sure it works.</p>

<p>The book has the reader work with email data: your Gmail inbox pulled locally for analyzing. I thought this was neat, in itself. Many data science tools use free datasets; as a result working with those datasets may not be the most interesting problem space to you. But insights about your own communication and how others communicate with you is something you might find more interesting.</p>

<p>After explaining Hadoop, Pig, and a few other tools, the rest of the book follows a fairly lightweight &#8220;recipe&#8221; format. Each chapter explains the goal and how it fits in an &#8220;agile data science&#8221; workflow. Then, some code is presented, and then we see what kinds of results we can take from that step. Once this pattern is set up, the book moves fairly quickly through some rather interesting data wrangling. By the end, the reader has built several data analysis scripts and a simple web app put together with MongoDB, Python Flask, and D3.js graphs to display all the results.</p>

<p>At times, though, the quick recipe format seemed to explain too little. There was little explanation of how Pig script syntax worked or how to understand what was going on under the covers. What this book is not: an exhaustive guide to how to write Pig scripts, how to pick approaches to analyzing a dataset, or how to compose these systems in production in the wild.  Also missing were any mention of performance tuning or what other algorithms might be considered.</p>

<p>Which seems like an awful lot to be missing, but for this book that would have been diversions that bogged the book down.</p>

<p>To the author&#8217;s benefit, I finished the book, and finished it far faster than I expected I would. I cam away having done almost all of the book&#8217;s examples (helped a great deal by the excellent virtual machine repo from Charles Flynn mentioned above). And, I had a deeper understanding and respect for tools that I&#8217;d never used before.</p>

<h2>Final thoughts</h2>

<p>When it comes down to it, I wouldn&#8217;t recommend Agile Data Science to read on its own. I&#8217;d recommend that you used it as a quick introductory book to build familiarity and confidence, so that you could dive into a deeper resource afterwards. I&#8217;d also recommend it if you&#8217;re a developer who isn&#8217;t going to be doing data science as your full time job but are curious about the tools and practices, this book would be a good read.</p>

<h2>What I&#8217;m doing next</h2>

<p>Almost immediately after finishing this book, I attended an event at a nearby college to talk about <a href="http://storm.incubator.apache.org/">Apache Storm</a>. Our company blog <a href="http://bendyworks.com/geekville/articles/2014/2/uw-big-data-event-presents-storm">covered the event</a> if you&#8217;re curious.</p>

<p>Storm is a tool that came out of Twitter for processing streams of big data. If you think about it, Twitter has one of the biggest streaming data sets ever. They need to use that streaming data for everything from recommendations to analytics to top tweet/hashtag rankings.</p>

<p>After attending the event and having run a word-counting topology (Storm&#8217;s term for a workflow that may contain many data-processing jobs) out on a cluster, I began to see the potential of using Storm.</p>

<p>Plus, Storm is far friendlier to local development on a laptop. One can run it with a simple command line tool or even from inside your Java or Clojure code. Or, perhaps most simply, from inside the Clojure REPL.</p>

<p>The other plus here is that Storm is mostly written in Clojure and has a full Clojure API. Combined with a few other Clojure tools that I prefer, like <a href="http://www.datomic.com/">Datomic</a>, <a href="https://github.com/ring-clojure/ring">Ring</a>, and <a href="http://keminglabs.com/c2/">C2</a>, I can see a toolset similar to that used in Agile Data Science. This toolset has the benefit of using the same language for everything. And, Clojure is already well-suited for data manipulation and processing.</p>

<p>So I began to rewrite the examples in Agile Data Science in Clojure. I am hoping to make enough progress to begin posting some of the code with explanations in blog format. Stay tuned for that.</p>

        
        
    </div>

    <div class="meta">
        <div class="author">
  

<span class="byline author vcard">Posted by <span class="fn">Matt Gauger</span>.</span>
</div>
        <div class="date">












<time datetime="2014-03-14T19:53:00-05:00" pubdate  data-updated="true" >Mar 14<span>th</span>, 2014</time>.</div>
        <div class="tags">

</div>
    </div>

  </article>


  <article class="post">
    
    <h1 class="title"><a href="/blog/2014/01/12/a-theory-of-compound-intelligence-gain/">A Theory of Compound Intelligence Gain</a></h1>
    <div class="entry">
        <p>Note that this is probably not enough to call a theory. It&#8217;s an idea, at most.</p>

<p>I&#8217;m currently reading the book <a href="http://www.amazon.com/gp/product/0984725113">Race Against the Machine</a>, which describes how increasing levels of automation by technology are related to capital and labor. But this post isn&#8217;t about that book. It simply triggered me to think about my motivations for my current side projects, and how I might explain to others why exactly I think that my current side projects are so important.</p>

<p>While <em>Race Against the Machine</em> describes technological progress as a force that leaves behind skilled workers who no longer have relevant skills, my thinking is on intelligence augmentation, and how I can use my own knowledge and programming skills to build tools that increase my own effectiveness and ability to perform my job. Namely, how can I write software that improves my cognition and memory such that I am better at writing software, and gain other benefits from having increased cognition and memory?</p>

<p>Douglas Engelbart <a href="http://www.dougengelbart.org/pubs/augment-3906.html">wrote extensively</a> about augmenting intelligence, primarily with improving workflows and then with computer software. I&#8217;ve previously <a href="http://blog.mattgauger.com/blog/2013/03/17/by-augmenting-human-intellect/">quoted him</a> on this blog. I feel that part of that quote bears repeating here:</p>

<blockquote>
By &#8220;augmenting human intellect&#8221; we mean increasing the capability of a man to approach a complex problem situation, to gain comprehension to suit his particular needs, and to derive solutions to problems.
<footer>
<strong>Douglas C. Engelbart</strong>
&ndash;
<cite><a href="http://www.dougengelbart.org/pubs/augment-3906.html">Augmenting Human Intellect: A Conceptual Framework </a></cite>
</blockquote>


<p>Of course, Engelbart was writing about this in 1962 &#8211; well before every home had a personal computer and everyone had a powerful supercomputer in their pocket. For a modern overview of Engelbart&#8217;s framework, see <a href="http://fluid.media.mit.edu/sites/default/files/The%20Design%20of%20Artifacts%20for%20Augmenting%20Intellect.pdf">The Design of Artifacts for Augmenting Intellect</a>.</p>

<p>My earliest encounters with concepts of intelligence augmentation most likely come from science fiction. One character that has inspired a lot of my work (and that I&#8217;ve probably told you a lot about if we&#8217;ve discussed this project in person) is Manfred Macx from Charles Stross&#8217;s <a href="http://www.antipope.org/charlie/blog-static/fiction/accelerando/accelerando.html">Accelerando</a>. Macx is described in the early parts of the book as having a wearable computer that acts as his <em>exocortex</em>. The idea of an exocortex being that some part of his memory, thinking, and information processing lives outside of his head and on the wearable computer. Similarly, the exocortex can help act as a gate to his attention, which is one of our limited resources.</p>

<p>If you think about it, just as <a href="http://www.ted.com/talks/amber_case_we_are_all_cyborgs_now.html">we are all cyborgs now</a> by virtue of the technology we use every day, we are also all on our way to having exocortexes. Many of us use Gmail filters to protect our attention spans from email we receive but don&#8217;t always need to read. Or we use Google search to add on to our existing memory, perhaps to remember some long-forgotten fact that we only have an inkling of.</p>

<p>I&#8217;ve had Manfred Macx&#8217;s exocortex (and other flavors of science fiction&#8217;s wearable computers and augmented intelligences) kicking around in my head for years. Gmail tells me that I was trying to plan the architecture for such a thing as far back as 2006. It&#8217;s taken a lot of thinking and further learning in my career to even get to the point where I felt ready to tackle such a project.</p>

<p>What I am setting out to build is an exocortex of my own design, under my own control. Not something that is handed to me by Google in bits and pieces. And to do so, it turns out, requires a lot of research and learning. There&#8217;s tons of research on the topics of proactive autonomous agents, text classification, and wearable computing that I have been reading up on. Just to build the first phase of my project, I have been learning all of the following:</p>

<ul>
<li><a href="https://github.com/clojure/core.logic">core.logic</a> (which is based on Prolog, so I&#8217;m learning some Prolog now, too)</li>
<li><a href="https://github.com/clojure/core.async">core.async</a> (Clojure&#8217;s implementation of C.A.R. Hoare&#8217;s <a href="http://www.amazon.com/Communicating-Sequential-Processes-International-Computing/dp/0131532715/">Communicating Sequential Processes</a>, which is also how Go&#8217;s goroutines work)</li>
<li><a href="http://cascalog.org/">Cascalog</a> and <a href="http://hadoop.apache.org/">Hadoop</a>, to do my distributed computing tasks</li>
<li><a href="http://www.datomic.com/">Datomic</a> &amp; Datalog (a subset of Prolog for querying Datomic), to store knowledge in a historical fashion that makes sense for a persistent, lifelong knowledge system</li>
<li>Topic clustering, text classification, and other natural language processing approaches</li>
<li>Data mining, and in particular, streaming data mining of large datasets on Hadoop clusters, by reading the Stanford textbook <a href="http://infolab.stanford.edu/~ullman/mmds.html">Mining of Massive Datasets</a></li>
<li>Generally learning Clojure and ClojureScript better</li>
<li>and probably more that I am forgetting to mention</li>
</ul>


<p>Of course, if I look at that list, I can be fairly certain that this project is already paying off. These are all things that I had very little experience with before, and very little reason to dig into so deeply. Not represented here are the 40 or so academic papers that I identified as important, and seriously set out to read and take notes on &#8211; again, probably learning more deeply these topics than I otherwise would have.</p>

<p>Which brings me to this theory, the idea of this post: That by even beginning to work on this problem, I&#8217;m seeing some gains, and that any tools I can build that give me further gains will only compound the impact and effectiveness. <strong>Improving cognition and learning compounds to allow further gains in cognition and learning.</strong></p>

<p>There&#8217;s some idea in the artificial intelligence community that we don&#8217;t need the first general artificial intelligence to be built as a super-intelligence; we need only build an artificial intelligence that is capable of improving itself (or a new generation of artificial intelligence.) As each generation improves, such intelligences could become unfathomably intelligent. But all it takes is that first seed AI that can improve the next.</p>

<p>So for improving our own human intelligences, we may not need to build a single device up-front that makes us massively intelligent. We only need take measures to improve our current knowledge and cognition, to build tools that will help us improve further, and continue down this path. It will definitely not be the exponential gains predicted for AI, and may not be even linear &#8211; that is, the gains in cognition from building further tools and learning more may plateau. But there will be improvements.</p>

<p>For that reason, I&#8217;m not setting out to build Manfred Macx&#8217;s exocortex from the beginning. Instead, I have been building what I describe as a &#8220;Instapaper clone for doing research&#8221; &#8211; a tool that, if it improves my existing ability to research and learn new topics, could pay off in helping me to build the next phase of my projects.</p>

<p>Of course, at the same time, I have an eye towards using the foundation of this tool as the datastore and relevance-finding tool for the overall project. Such a tool can automatically go and find related content &#8211; either things I have read, or simply crawl related content on the web. Eventually, this tool will also ingest all of the information I interact with on a daily basis: every website I browse, every email I receive, every book that I read. A searchable, tagged, annotatable reference with full metadata for each document as an external long-term memory. But this is all a topic for another post.</p>

<p>This, in concert with what current research tells us is effective: <a href="http://www.salon.com/2013/12/29/sciences_obsession_the_search_for_a_smart_pill/">improved nutrition and supplementation, exercise, meditation, and N-back training</a>, may just be my ticket to higher levels of human intelligence. But for now, I just want the early-adopter edge. I want to see how far I can push myself on my own skills. Some large corporation may be able to field hundreds of developers to create a consumer product for the public that benefits everyone in similar ways &#8211; but I might be able to do this for myself years ahead of that. And wouldn&#8217;t that be cool?</p>

<p>And this is where I call it a theory: it could very well be that there&#8217;s no such thing as compounding interest on intelligence. Only time and my own experiences with this project will tell me.</p>

<p>If you&#8217;ve made it this far and you&#8217;re interested in this kind of stuff, that is: intelligence augmentation, wearable computing, autonomous proactive agents, etc., <a href="https://twitter.com/mathiasx">get in touch</a>. There doesn&#8217;t seem to be much of an online community around these topics, and I&#8217;d like to start creating one for discussion and organizing open source projects around these topics.</p>

        
        
    </div>

    <div class="meta">
        <div class="author">
  

<span class="byline author vcard">Posted by <span class="fn">Matt Gauger</span>.</span>
</div>
        <div class="date">












<time datetime="2014-01-12T14:02:00-06:00" pubdate  data-updated="true" >Jan 12<span>th</span>, 2014</time>.</div>
        <div class="tags">

</div>
    </div>

  </article>


  <article class="post">
    
    <h1 class="title"><a href="/blog/2013/12/28/an-unscientific-study-in-behavior-change-with-software/">An (Unscientific) Study in Behavior Change With Software</a></h1>
    <div class="entry">
        <p>Forming habits is hard. There&#8217;s been tons of research on what practices help form new habits successfully. And there has been research on what software can do to help form new habits. It&#8217;s not enough to simply send daily reminders or keep track of the goals in a visible place. For software to help us form new habits successfully, we must look to the current research for clues as to how habits are formed.</p>

<p>Over the past year or so, I&#8217;ve been trying to adopt a habit to take Vitamin D every morning. I&#8217;ve been largely successful, which I think is partly due to the software I used. I use <a href="http://lift.do">Lift</a> on my iPhone, which sends me emails every morning as a reminder. The app itself has checkins for each habit, progress charts, and social features. Most mornings, I wake up, swipe away the reminder email, and take my morning antihistamine and a Vitamin D. <a href="#behavior-footnote-1" name="behavior-footnote-1-return">[1]</a> Like I said, I&#8217;ve been mostly successful, and at this point, I&#8217;ve taken Vitamin D every day in a row for 442 days in a row. <a href="#behavior-footnote-2" name="behavior-footnote-2-return">[2]</a>  Granted, taking a vitamin every morning is only a small change, but it is one that I wanted to accomplish and did. Small successes add up to bigger successes, and this gives me confidence that if I set out to make a bigger change in my life, I have a toolset that will help me to accomplish that goal.</p>

<p>So what does the research say helps us form successful habits? The Fogg Method <a href="#behavior-footnote-3" name="behavior-footnote-3-return">[3]</a> is one of the more well-known systems, and suggests that a way to be successful is to:</p>

<ol>
<li>Select the right target behavior.</li>
<li>Make the target behavior easy to do.</li>
<li>Ensure a trigger will prompt the behavior.</li>
</ol>


<p>So what do each of these steps tell us?</p>

<h2>The Right Target Behavior</h2>

<p>It&#8217;s hard to be successful in picking up a habit that you don&#8217;t already want to accomplish. Some things you may already want to do include things like learning a language, eating a specific diet, or flossing your teeth. It goes without saying that things you&#8217;d rather not do are going to be harder to implement.</p>

<p>But there&#8217;s another factor in play here that I think determines the <strong>right</strong> target behavior: simplicity. That is, is the habit a simple task to accomplish, or is it something complex and unmanageable? Can you perform one simple task per day and call it &#8220;done&#8221;, or is it more complicated as to whether it is &#8220;done&#8221; or not each day? The simple &#8220;done&#8221; state seems really important, and so it is good to focus on using this technique for binary actions: either you did them today, or you didn&#8217;t. Things that must be done with complicated schedules, every other day, or once a week, will be much harder to establish as habits.</p>

<h2>Easy to do</h2>

<p>One reason we want a simple target behavior is so that it is easy for us to add to our schedule. You may have a goal of exercising more. But &#8220;exercising more&#8221; doesn&#8217;t have a binary action associated with it; for example: what is &#8220;more&#8221;? Instead, you might say, &#8220;I want to exercise 45 minutes per day.&#8221; And that would be a much better goal. But if exercising means you have to drive to the gym, and the gym is out of your way each day, it might be very unlikely that you will do it. This is not a simple target behavior.</p>

<p>If you do have some goal that may not be simple to implement at first &mdash; say, the example of having to drive out of your way to the gym &mdash; instead try to find a simpler version of the habit that you can adopt first. You may decide instead to just do some bodyweight exercises before you leave for work each morning. Decide on the exercises and write them down. Either you did them or you didn&#8217;t. Later on, you can modify this existing habit to be more exercise, but for now, focus on what you can reasonably adopt as a simple habit.</p>

<p>The other concern in implementing an &#8220;easy&#8221; habit is how much time the new habit will take. In the above example, the initial goal was something like 45 minutes per day. Eventually, you could probably find when you exercise best and are least likely to schedule appointments (say, early morning or late at night), and actually implement that goal. But early on, it&#8217;s going to be hard to change your schedule for your new habit. I ran into this frequently while trying to find time after 5PM but before dinner to practice guitar. It didn&#8217;t help that after-work and dinnertime are frequently scheduled as social events, and that I have a habit of staying at the office past 5; all these added up to very little success in trying to spend 45 minutes to an hour practicing guitar at home after work.</p>

<h2>Triggers</h2>

<p>The last step is quite important. Where you might think of triggers as things like alerts on your phone or daily emails from a service like <a href="http://lift.do">Lift</a>, I didn&#8217;t find those kinds of prompts very effective in helping me adopt a habit.</p>

<p>To be more likely to perform some task on any given day, look at the habits you already have. I&#8217;ve been taking an antihistamine every morning since I was about 12; this has been a constant in my life and part of my routine for a very long time. Since I already have this daily habit, I added taking Vitamin D every morning to that habit. Other habits with no daily routine to hinge off of, like practicing guitar, were much harder to make stick.</p>

<p>Flossing is an easy addition to brushing your teeth every night, and just took enough of me making it simpler (finding a brand of flossers I liked rather than wrangling loose floss) and doing it enough times before it stuck, too.</p>

<h2>What didn&#8217;t work for me?</h2>

<p>As noted above, despite a couple attempts to really make daily guitar practice stick, I&#8217;ve never been able to tackle that habit. There were no good triggers that I could add the event on to, and I frequently didn&#8217;t have time for what I was trying to accomplish. If I were to go back to trying to focus on guitar, I&#8217;d probably start with much less time commitment, and schedule it some time when I&#8217;m very likely to be home and have 5-10 minutes, like early in the morning before work. Whether or not guitar practice is effective with my first cup of coffee would have to be tested, of course.</p>

<p>What I&#8217;ve found is that I&#8217;m partially motivated by progress bars and graphs, though, and so I will make time in my day for easy-to-accomplish things. So when I can, I will try to squeeze in some mundane activity I&#8217;m tracking in Lift, like washing the dishes. <a href="#behavior-footnote-4" name="behavior-footnote-4-return">[4]</a></p>

<p>The social component of Lift, on the other hand, doesn&#8217;t really help me any. For others, it might be a good motivator. In cycling, I have several local friends, including one local cyclist who is quite prolific and who frequently rides 10x as much as I do in a given week. We all use <a href="http://www.strava.com/">Strava</a> to track our cycling, and the social component alerts me to new rides that the prolific cyclist has done. Seeing that cyclist&#8217;s rides helps remind me to get out and enjoy more cycling, as well as sets up a nice carrot-on-a-stick for me to ride more to &#8220;catch up.&#8221; In that case, the social features definitely help me to perform an action more, but I wouldn&#8217;t really call cycling a habit as much as my transportation and leisure-time hobby that I can do whenever I have time.</p>

<p>Habits with no simple binary action and no triggers, such as creative acts, are especially hard to form as habits. I have tracked writing blog posts in Lift for some time, but since I only write blog posts when the mood strikes me, it is hardly a daily goal, and it would be difficult for me to implement the above steps to form an actual habit of blogging on a daily basis.</p>

<h2>Final thoughts</h2>

<p>Notice that most of the guidelines above have very little to do with software? Software itself can&#8217;t convince you to go to the gym or make you more likely to floss. But it can provide some prompts and some encouragement, and that might be enough to get you over the hurdle of adopting a new habit.</p>

<p>As with anything, you are an individual and your mileage may vary. Experiment, use an app like Lift or something else you prefer to track your progress, and see where it takes you.</p>

<p>There&#8217;s more resources out there to help understand forming new habits, self-control, and behavior change, but I feel like this is the baseline one needs to know to be more successful in implementing behavior change. Some references of note that I have been consuming:</p>

<ol>
<li><a href="http://shop.oreilly.com/product/0636920030201.do">Designing for Behavior Change</a>. Stephen Wendel. 2013.</li>
<li><a href="http://www.nytimes.com/2011/09/04/books/review/willpower-by-roy-f-baumeister-and-john-tierney-book-review.html?pagewanted=a0l&amp;_r=0">The Sugary Secret of Self-Control</a>. New York Times. September 2, 2011.</li>
<li><a href="http://pragprog.com/book/jkthp/the-healthy-programmer">The Healthy Programmer</a>. Joe Kutner. 2013.</li>
</ol>


<p>If you&#8217;re interested in some research, the above book (Designing for Behavior Change) is a good reference, as well as these papers:</p>

<ol>
<li><a href="http://dspace.mit.edu/handle/1721.1/79306">ReflectOns : mental prostheses for self-reflection</a> (hardware and software solutions)</li>
<li><a href="http://captology.stanford.edu/wp-content/uploads/2010/10/Fogg-and-Hreha-BehaviorWizard.pdf">Behavior Wizard: A Method for Matching Target Behaviors with Solutions</a></li>
</ol>


<hr />

<p><a name="behavior-footnote-1"></a></p>

<p><strong>1</strong> Yes, I&#8217;m aware of the fact that taking vitamins with an antihistamine decreases the effectiveness of the antihistamine. I&#8217;ll cover why I take them at the same time in this post. <a href="#behavior-footnote-1-return">&#8617;</a></p>

<p><a name="behavior-footnote-2"></a></p>

<p><strong>2</strong> You can view my progress on Lift <a href="https://lift.do/users/34b3bcceda0808f3c096">on my public profile</a>. Notice there&#8217;s quite a few habits I&#8217;ve tried to form with Lift in the past that didn&#8217;t quite work. <a href="#behavior-footnote-2-return">&#8617;</a></p>

<p><a name="behavior-footnote-3"></a></p>

<p><strong>3</strong> As described by BJ Fogg in the preface to <a href="http://shop.oreilly.com/product/0636920030201.do">Designing for Behavior Change</a>. <a href="#behavior-footnote-3-return">&#8617;</a></p>

<p><a name="behavior-footnote-4"></a></p>

<p><strong>4</strong> We don&#8217;t have a dishwasher in our current apartment, and I both dislike dirty dishes and dislike washing dishes by hand. <a href="#behavior-footnote-4-return">&#8617;</a></p>

        
        
    </div>

    <div class="meta">
        <div class="author">
  

<span class="byline author vcard">Posted by <span class="fn">Matt Gauger</span>.</span>
</div>
        <div class="date">












<time datetime="2013-12-28T08:54:00-06:00" pubdate  data-updated="true" >Dec 28<span>th</span>, 2013</time>.</div>
        <div class="tags">

</div>
    </div>

  </article>


<ul class="pager">
  
  
    <li>
    <a href="/blog/page/2/" class="next">Next</a>
    </li>
  
</ul>

<a href="/blog/archives" class="center">
  <i class="icon-th-list"></i> 
  Blog Archives
</a>

  </article>
</div>

    <hr />
	  <footer class="footer"><div class="row">
  <div class="offset2 span2">
    <img src="/images/mathiasx.jpg" alt="portrait">
  </div>
  <div class="span3">
    <p><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="https://github-camo.global.ssl.fastly.net/cc898278e77203243a0b63be665d38fa75dcf04a/687474703a2f2f692e6372656174697665636f6d6d6f6e732e6f72672f6c2f62792d6e632d73612f332e302f38387833312e706e67" alt="Creative Commons License Image" data-canonical-src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" style="max-width:100%;"></a>
blog.mattgauger.com
by <a href="http://blog.mattgauger.com">Matt Gauger</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons
Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>

  </div>
  <div class="offset1 span3">
    <ul class="nav nav-list">
      <li><a href="https://twitter.com/mathiasx">Twitter</a></li>
      <li><a href="https://github.com/mathias">Github</a></li>
      <li><a href="/presentations">Presentations</a></li>
      <li><a href="http://hackz0r.tumblr.com">hackz0r links (tumblog)</a></li>
      <li><a href="/atom.xml">Atom feed</a></li>
    </ul>
  </div>
</div>
</footer>
  </div>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script src="/javascripts/bootstrap-alert.js"></script>
<script src="/javascripts/bootstrap-button.js"></script>
<script src="/javascripts/bootstrap-collapse.js"></script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38944731-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
